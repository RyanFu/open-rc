<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket</title>
</head>

<body>
    <input type="text" />
    <input type="button" onclick="sendMessage();" value="发送" />
</body>

</html>

<script type="text/javascript" src="Decoder.js"></script>
<script type="text/javascript" src="YUVCanvas.js"></script>
<script type="text/javascript" src="Player.js"></script>
<script type="text/javascript" src="stream.js"></script>

<script type="text/javascript">
    var player = new Player({
        width: 1080,
        height: 1920
    });

    document.body.appendChild(player.canvas);

    var index = 0
    var ws = new WebSocket("ws://172.16.10.43:8887"); // "ws://172.16.11.71:8887"
    ws.binaryType = "arraybuffer";

    function sendMessage() {
        console.log("send message")
        ws.send(`haha ${index++}`)
    }

    ws.onopen = function () {
        console.log("onopen")
    }

    ws.onmessage = function (msg) {
        console.log(`onmessage = ${msg}`)
        var messageData = new Uint8Array(msg.data);
        player.decode(messageData);
    }

    ws.onclose = function () {
        console.log("onclose")
    }
</script>